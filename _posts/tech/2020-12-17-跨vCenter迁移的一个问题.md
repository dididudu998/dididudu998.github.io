---
layout: post
title: 跨vCenter 移动VM报“DataCenterMismatchArgument to Object”的问题
category: tech
tags: [vcenter,move-vm,vmware]
description: 
---

# 跨vCenter移动vm出现“datacentermismatchargument to object"的问题

应该是前天做虚拟机迁移的时候用自己以前的迁移脚本，出现了这个问题。在想，是不是因为不同vCenter的版本导致的。源vCenter是6.7，目标vCenter是7.0.感觉如果要是这个原因，那就麻烦了。

又想着升级6.7的vCenter到7.0.但是问题又来了，6.7的vCenter上面乱七八糟，用VMware的迁移升级工具，报超时。也就是没法用工具迁移。

昨天想了这个方案：
1. 备份6.7的数据库
2. 建一个新的6.7的vCenter
3. 还原数据库到这个新的vCenter
4. 迁移这个新的vCenter到7.0
5. 断开连接到旧的6.7的vCenter的esxi主机
6. 在新的vCenter 7上面连接这些esxi主机

感觉是可以实现，但是这个月没时间来做这个操作了。明年1月再说。

回到这个datacentermismatchargument的问题。

网上搜了一下，各种说法都有，但是看不出有什么借鉴的，因为配置了没用。

到了昨天下午，试着clone了一个VM，再用脚本迁移，成了。。。。。

调查了一下问题，看到成了的VM的数据是存在标准的DATASTORE中的，而不成的是存在存储数据集群的。

我当时为了管理的方便，做了几个存储数据集群。

将移动报错的VM迁移到标准的数据存储后，再用脚本进行移动，成功。

接着尝试了将另外存在标准数据存储的vm移动到存储数据集群中，再进行移动，也是成功的。莫名了。。。。。

到底是什么原因导致的报错啊？

不是因为vCenter的版本的原因。也不全是VM存储的方式的原因。也不是VM的版本的原因。。。

但是可以说明的是，我只要做了几次VM在当前vCenter的存储迁移后，就可以进行跨vCenter的迁移。

现在静不下来看vmware的api文档，权且这样吧。无非就是多迁移几次存储。
